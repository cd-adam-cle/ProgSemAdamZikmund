Server Components in Next.js 14

By default, all components in the app/ directory are React Server Components.

Benefits:
- Run on the server
- Direct database access
- Better performance
- Smaller bundle size
- Keep sensitive data on server
- Improved SEO
- Faster initial page load

Server Components can:
- Fetch data directly
- Access backend resources
- Use async/await
- Read from filesystem

Example Server Component:
export default async function Page() {
  const data = await fetch('https://api.example.com/data')
  const posts = await data.json()

  return (
    <div>
      {posts.map(post => (
        <div key={post.id}>{post.title}</div>
      ))}
    </div>
  )
}

Client Components:
Use 'use client' directive at the top of the file for components that need:
- Interactivity and event listeners
- State (useState, useReducer)
- Effects (useEffect)
- Browser-only APIs
- Custom hooks

Example Client Component:
'use client'

import { useState } from 'react'

export default function Counter() {
  const [count, setCount] = useState(0)

  return (
    <button onClick={() => setCount(count + 1)}>
      Count: {count}
    </button>
  )
}

Best Practices:
1. Keep Client Components at the leaf of the component tree
2. Pass data from Server to Client Components as props
3. Use Server Components for data fetching
4. Use Client Components for interactivity
5. Server Components cannot be imported into Client Components
6. Client Components can receive Server Components as children

Composition Pattern:
// ServerComponent.tsx (Server Component)
import ClientComponent from './ClientComponent'

export default function ServerComponent() {
  const data = fetchData()

  return (
    <ClientComponent>
      <ServerChildComponent data={data} />
    </ClientComponent>
  )
}

Data Fetching in Server Components:
- Use async/await directly in components
- Use fetch() with automatic caching
- Access databases directly
- No need for useEffect or client-side fetching

Caching:
Next.js automatically caches fetch() requests:
- fetch(url) - cached by default
- fetch(url, { cache: 'no-store' }) - no caching
- fetch(url, { next: { revalidate: 60 } }) - revalidate every 60 seconds
